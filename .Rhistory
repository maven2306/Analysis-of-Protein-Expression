knitr::opts_chunk$set(echo = TRUE)
# if (!require("BiocManager", quietly = TRUE))
#     install.packages("BiocManager")
#
# BiocManager::install("Biostrings")
# BiocManager::install("mzR")
# BiocManager::install("Spectra")
# install.packages("microseq")
library(microseq)
library(dplyr)
library(ggplot2)
df <- readFasta("iPRG2015.fasta")
knitr::opts_chunk$set(echo = TRUE)
# if (!require("BiocManager", quietly = TRUE))
#     install.packages("BiocManager")
#
# BiocManager::install("Biostrings")
# BiocManager::install("mzR")
# BiocManager::install("Spectra")
# install.packages("microseq")
library(microseq)
library(dplyr)
library(ggplot2)
df <- readFasta("Data/iPRG2015.fasta")
head(df)
reverse_string <- function(x) {
paste0(rev(strsplit(x, "")[[1]]), collapse = "")
}
decoy <- df
decoy$Sequence <- sapply(df$Sequence, reverse_string)
decoy$Header <- sub("^sp\\|", "sp|D_", df$Header)
write_fasta <- function(df, file) {
con <- file(file, "w")
on.exit(close(con))
for (i in seq_len(nrow(df))) {
header <- paste0(">", df$Header[i])
seq    <- df$Sequence[i]
writeLines(header, con)
writeLines(seq, con)
}
}
write_fasta(decoy, "decoy.fasta")
library(mzR)
# load target
filename_t <- "searchgui_results/target_results/JD_06232014_sample1-A.comet.pep.xml.gz"
mzid_t <- openIDfile(filename_t)
